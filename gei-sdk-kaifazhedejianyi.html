<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.49">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <title>给 SDK 开发者的建议 | Sisters.WudiLib</title><meta name="description" content=".NET 平台 OneBot 通信框架">
    <link rel="modulepreload" href="/assets/app.b860a506.js"><link rel="modulepreload" href="/assets/gei-sdk-kaifazhedejianyi.html.e4f3ece2.js"><link rel="modulepreload" href="/assets/gei-sdk-kaifazhedejianyi.html.e84a1f4d.js"><link rel="prefetch" href="/assets/index.html.cd803806.js"><link rel="prefetch" href="/assets/lantu.html.e05cd811.js"><link rel="prefetch" href="/assets/luxiantu.html.98e333a5.js"><link rel="prefetch" href="/assets/API.html.7b5df50e.js"><link rel="prefetch" href="/assets/CQ-ma.html.1ef6d418.js"><link rel="prefetch" href="/assets/index.html.41411520.js"><link rel="prefetch" href="/assets/shijian.html.6a465fef.js"><link rel="prefetch" href="/assets/tongxinfangshi.html.c6c56305.js"><link rel="prefetch" href="/assets/index.html.66b217ff.js"><link rel="prefetch" href="/assets/fanxiang-websocket.html.307bac4f.js"><link rel="prefetch" href="/assets/http.html.4c0ec876.js"><link rel="prefetch" href="/assets/zhengxiang-websocket.html.1208684a.js"><link rel="prefetch" href="/assets/jinjie-wudilib.html.ec1e237b.js"><link rel="prefetch" href="/assets/kuaisushangshou.html.cc0bb7ec.js"><link rel="prefetch" href="/assets/404.html.265028f6.js"><link rel="prefetch" href="/assets/index.html.835e9e94.js"><link rel="prefetch" href="/assets/lantu.html.8af9ed4a.js"><link rel="prefetch" href="/assets/luxiantu.html.f786bf09.js"><link rel="prefetch" href="/assets/API.html.84acef67.js"><link rel="prefetch" href="/assets/CQ-ma.html.63684031.js"><link rel="prefetch" href="/assets/index.html.8f0056b0.js"><link rel="prefetch" href="/assets/shijian.html.85c7c784.js"><link rel="prefetch" href="/assets/tongxinfangshi.html.b2edc1f9.js"><link rel="prefetch" href="/assets/index.html.036a97ff.js"><link rel="prefetch" href="/assets/fanxiang-websocket.html.c96cc665.js"><link rel="prefetch" href="/assets/http.html.613a8466.js"><link rel="prefetch" href="/assets/zhengxiang-websocket.html.19445657.js"><link rel="prefetch" href="/assets/jinjie-wudilib.html.247884cd.js"><link rel="prefetch" href="/assets/kuaisushangshou.html.f1d7a0bb.js"><link rel="prefetch" href="/assets/404.html.4965bd1a.js"><link rel="prefetch" href="/assets/404.ed9901a6.js"><link rel="prefetch" href="/assets/Layout.ee9f71e9.js">
    <link rel="stylesheet" href="/assets/style.f4d22aab.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><!----><span class="site-name">Sisters.WudiLib</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/" class="" aria-label="主页"><!--[--><!--]--> 主页 <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="指南"><span class="title">指南</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="指南"><span class="title">指南</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/zhinan/kuaisushangshou.html" class="" aria-label="快速上手"><!--[--><!--]--> 快速上手 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/zhinan/jinjie-wudilib.html" class="" aria-label="进阶 WudiLib"><!--[--><!--]--> 进阶 WudiLib <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="通信方式"><span class="title">通信方式</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="通信方式"><span class="title">通信方式</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/tongxinfangshi/" class="" aria-label="通信方式"><!--[--><!--]--> 通信方式 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/tongxinfangshi/http.html" class="" aria-label="HTTP 和 HTTP POST"><!--[--><!--]--> HTTP 和 HTTP POST <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/tongxinfangshi/zhengxiang-websocket.html" class="" aria-label="正向 WebSocket"><!--[--><!--]--> 正向 WebSocket <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/tongxinfangshi/fanxiang-websocket.html" class="" aria-label="反向 WebSocket"><!--[--><!--]--> 反向 WebSocket <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="扩展 WudiLib"><span class="title">扩展 WudiLib</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="扩展 WudiLib"><span class="title">扩展 WudiLib</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/kuozhan/" class="" aria-label="扩展概述"><!--[--><!--]--> 扩展概述 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/kuozhan/API.html" class="" aria-label="扩展 API"><!--[--><!--]--> 扩展 API <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/kuozhan/CQ-ma.html" class="" aria-label="扩展 CQ 码"><!--[--><!--]--> 扩展 CQ 码 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/kuozhan/tongxinfangshi.html" class="" aria-label="扩展通信方式"><!--[--><!--]--> 扩展通信方式 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/kuozhan/shijian.html" class="" aria-label="扩展事件"><!--[--><!--]--> 扩展事件 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="未来"><span class="title">未来</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="未来"><span class="title">未来</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/luxiantu.html" class="" aria-label="路线图"><!--[--><!--]--> 路线图 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lantu.html" class="" aria-label="蓝图"><!--[--><!--]--> 蓝图 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a aria-current="page" href="/gei-sdk-kaifazhedejianyi.html" class="router-link-active router-link-exact-active router-link-active" aria-label="给 SDK 开发者的建议"><!--[--><!--]--> 给 SDK 开发者的建议 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/int-and-his-friends/Sisters.WudiLib" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/" class="" aria-label="主页"><!--[--><!--]--> 主页 <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="指南"><span class="title">指南</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="指南"><span class="title">指南</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/zhinan/kuaisushangshou.html" class="" aria-label="快速上手"><!--[--><!--]--> 快速上手 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/zhinan/jinjie-wudilib.html" class="" aria-label="进阶 WudiLib"><!--[--><!--]--> 进阶 WudiLib <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="通信方式"><span class="title">通信方式</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="通信方式"><span class="title">通信方式</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/tongxinfangshi/" class="" aria-label="通信方式"><!--[--><!--]--> 通信方式 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/tongxinfangshi/http.html" class="" aria-label="HTTP 和 HTTP POST"><!--[--><!--]--> HTTP 和 HTTP POST <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/tongxinfangshi/zhengxiang-websocket.html" class="" aria-label="正向 WebSocket"><!--[--><!--]--> 正向 WebSocket <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/tongxinfangshi/fanxiang-websocket.html" class="" aria-label="反向 WebSocket"><!--[--><!--]--> 反向 WebSocket <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="扩展 WudiLib"><span class="title">扩展 WudiLib</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="扩展 WudiLib"><span class="title">扩展 WudiLib</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/kuozhan/" class="" aria-label="扩展概述"><!--[--><!--]--> 扩展概述 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/kuozhan/API.html" class="" aria-label="扩展 API"><!--[--><!--]--> 扩展 API <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/kuozhan/CQ-ma.html" class="" aria-label="扩展 CQ 码"><!--[--><!--]--> 扩展 CQ 码 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/kuozhan/tongxinfangshi.html" class="" aria-label="扩展通信方式"><!--[--><!--]--> 扩展通信方式 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/kuozhan/shijian.html" class="" aria-label="扩展事件"><!--[--><!--]--> 扩展事件 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="未来"><span class="title">未来</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="未来"><span class="title">未来</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/luxiantu.html" class="" aria-label="路线图"><!--[--><!--]--> 路线图 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/lantu.html" class="" aria-label="蓝图"><!--[--><!--]--> 蓝图 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a aria-current="page" href="/gei-sdk-kaifazhedejianyi.html" class="router-link-active router-link-exact-active router-link-active" aria-label="给 SDK 开发者的建议"><!--[--><!--]--> 给 SDK 开发者的建议 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/int-and-his-friends/Sisters.WudiLib" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading">给 SDK 开发者的建议 <!----></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/gei-sdk-kaifazhedejianyi.html#想清楚定位" class="router-link-active router-link-exact-active sidebar-item" aria-label="想清楚定位"><!--[--><!--]--> 想清楚定位 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/gei-sdk-kaifazhedejianyi.html#先积攒一定的经验" class="router-link-active router-link-exact-active sidebar-item" aria-label="先积攒一定的经验"><!--[--><!--]--> 先积攒一定的经验 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/gei-sdk-kaifazhedejianyi.html#充分参考现有项目-吸收现有项目的优点" class="router-link-active router-link-exact-active sidebar-item" aria-label="充分参考现有项目，吸收现有项目的优点"><!--[--><!--]--> 充分参考现有项目，吸收现有项目的优点 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/gei-sdk-kaifazhedejianyi.html#简单的-sdk" class="router-link-active router-link-exact-active sidebar-item" aria-label="简单的 SDK"><!--[--><!--]--> 简单的 SDK <!--[--><!--]--></a><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/gei-sdk-kaifazhedejianyi.html#避免过度设计" class="router-link-active router-link-exact-active sidebar-item" aria-label="避免过度设计"><!--[--><!--]--> 避免过度设计 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/gei-sdk-kaifazhedejianyi.html#注重可扩展性" class="router-link-active router-link-exact-active sidebar-item" aria-label="注重可扩展性"><!--[--><!--]--> 注重可扩展性 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/gei-sdk-kaifazhedejianyi.html#控制依赖" class="router-link-active router-link-exact-active sidebar-item" aria-label="控制依赖"><!--[--><!--]--> 控制依赖 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/gei-sdk-kaifazhedejianyi.html#开启-nullable-reference-types" class="router-link-active router-link-exact-active sidebar-item" aria-label="开启 nullable reference types"><!--[--><!--]--> 开启 nullable reference types <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/gei-sdk-kaifazhedejianyi.html#完整框架" class="router-link-active router-link-exact-active sidebar-item" aria-label="完整框架"><!--[--><!--]--> 完整框架 <!--[--><!--]--></a><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/gei-sdk-kaifazhedejianyi.html#di-是绝对必要的" class="router-link-active router-link-exact-active sidebar-item" aria-label="DI 是绝对必要的"><!--[--><!--]--> DI 是绝对必要的 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/gei-sdk-kaifazhedejianyi.html#保留一定的灵活性" class="router-link-active router-link-exact-active sidebar-item" aria-label="保留一定的灵活性"><!--[--><!--]--> 保留一定的灵活性 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/gei-sdk-kaifazhedejianyi.html#考虑-ide-集成" class="router-link-active router-link-exact-active sidebar-item" aria-label="考虑 IDE 集成"><!--[--><!--]--> 考虑 IDE 集成 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/gei-sdk-kaifazhedejianyi.html#泛泛的建议" class="router-link-active router-link-exact-active sidebar-item" aria-label="泛泛的建议"><!--[--><!--]--> 泛泛的建议 <!--[--><!--]--></a><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/gei-sdk-kaifazhedejianyi.html#多读文档-正确地运用-c-语言特性" class="router-link-active router-link-exact-active sidebar-item" aria-label="多读文档，正确地运用 C# 语言特性"><!--[--><!--]--> 多读文档，正确地运用 C# 语言特性 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/gei-sdk-kaifazhedejianyi.html#多阅读优秀项目源码" class="router-link-active router-link-exact-active sidebar-item" aria-label="多阅读优秀项目源码"><!--[--><!--]--> 多阅读优秀项目源码 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/gei-sdk-kaifazhedejianyi.html#总结" class="router-link-active router-link-exact-active sidebar-item" aria-label="总结"><!--[--><!--]--> 总结 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="给-sdk-开发者的建议" tabindex="-1"><a class="header-anchor" href="#给-sdk-开发者的建议" aria-hidden="true">#</a> 给 SDK 开发者的建议</h1><p>如果你对现有的 OneBot C# SDK 都不满意，并打算自己再造一个轮子，为了避免重复陷入弯路，请认真考虑以下建议。</p><p>当然，我的水平只能给刚开始实践 C# 编程的新晋开发者提供一些建议。对于有经验的大佬，我说的很可能是正确的废话，甚至部分内容干脆是片面的。恳请各位大佬斧正。</p><h2 id="想清楚定位" tabindex="-1"><a class="header-anchor" href="#想清楚定位" aria-hidden="true">#</a> 想清楚定位</h2><p>目前 OneBot SDK 就应有两种不同的定位。用 .NET 官方的项目进行类比，一种是类似于 <a href="https://docs.microsoft.com/en-us/dotnet/api/system.net.httplistener" target="_blank" rel="noopener noreferrer">HttpListener<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span></a> 的简单访问库，这也是 WudiLib 的定位；另一种是类似于 <a href="https://dotnet.microsoft.com/apps/aspnet" target="_blank" rel="noopener noreferrer">ASP.NET Core<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span></a> 这种包含完整的命令处理的大框架，<a href="https://github.com/b11p/OsuQqBotForNewbieGroup/tree/master/Bleatingsheep.NewHydrant.Bot" target="_blank" rel="noopener noreferrer">我也有这种框架<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span></a>，但我觉得目前的质量还不值得拿出来给大家使用。前者应尽可能简单，后者可以依赖前者。如果搞不清楚自己的定位，就会出现过度或不伦不类的设计。</p><p>对于简单的 SDK，主要任务是处理请求、反序列化等，将 bot 开发者从繁杂的重复工作中解放出来。例如 <a href="https://github.com/howmanybots/onebot/blob/master/v11/specs/api/public.md" target="_blank" rel="noopener noreferrer">公开 API<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span></a> 中每一个 API 都有不同的参数和返回类型，SDK 应该定义好所对应的请求方法和返回类型，这样 bot 开发者就可以快速开发出包含简单功能的 bot，并享受 C# 强静态类型带来的便利。</p><p>对于功能完整的框架，除了上面简单 SDK 的任务，还应该包含指令路由、日志、生命周期管理等功能。这样就可以提高 bot 应用的稳定性和可维护性。</p><p>除此之外，<a href="https://v2.nonebot.dev/" target="_blank" rel="noopener noreferrer">NoneBot2<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span></a> 等框架还带插件商店，可以运行其他人写的插件，有点儿接近以前的酷 Q 了。我没有发布插件让别人运行的经验，无权对此指点江山。因此本页面主要讨论 bot 开发者和运营者是同一人，你的 SDK 或框架为此类人服务的情况。</p><h2 id="先积攒一定的经验" tabindex="-1"><a class="header-anchor" href="#先积攒一定的经验" aria-hidden="true">#</a> 先积攒一定的经验</h2><p>我强烈建议所有人不要冒然开始开发 SDK 或框架，而是先做一个包含一定功能的 bot。尤其是目前绝大多数 SDK/框架开发者还只是学生（我也是）的情况下。SDK 可能还好，因为比较简单；框架则会牵扯到更多东西，至少要有几个不同的数据来源，经历几次需求变更（例如本来依赖的服务变得不可用），才能更好地理解 bot 开发者对框架的需求。</p><h2 id="充分参考现有项目-吸收现有项目的优点" tabindex="-1"><a class="header-anchor" href="#充分参考现有项目-吸收现有项目的优点" aria-hidden="true">#</a> 充分参考现有项目，吸收现有项目的优点</h2><p>无论你要开发 SDK 还是框架，我都建议你浏览现有的几个 C# OneBot SDK/框架，甚至也应该参考其他一些语言的框架。考虑这么设计或实现的优点和缺点是什么，取长补短，避免走其他人走过的弯路。</p><h2 id="简单的-sdk" tabindex="-1"><a class="header-anchor" href="#简单的-sdk" aria-hidden="true">#</a> 简单的 SDK</h2><h3 id="避免过度设计" tabindex="-1"><a class="header-anchor" href="#避免过度设计" aria-hidden="true">#</a> 避免过度设计</h3><p>如果你要设计一个用来收发消息和事件的简单 SDK，请保持设计简单。这种 SDK 只需要收、发、API 列表、事件解析和分发各一个基类或接口（根据需要创建子类），并定义一些事件和 API 响应的类即可。</p><h3 id="注重可扩展性" tabindex="-1"><a class="header-anchor" href="#注重可扩展性" aria-hidden="true">#</a> 注重可扩展性</h3><p>OneBot 协议只规定了基础的 API、事件列表和三（或四）种通信方式，其中每项都可以进行扩展。bot 开发者使用和 SDK 开发者不同的 OneBot 实现是完全可能的。如果 bot 开发者想访问某个 API，而这个 API 在 OneBot 标准和其他实现中都没有，他会希望 SDK 开发者预留了相应的方式使其访问此 API。同理，bot 开发者可能用不同的通信方式和事件列表，SDK 应预留对应的可扩展性。</p><h3 id="控制依赖" tabindex="-1"><a class="header-anchor" href="#控制依赖" aria-hidden="true">#</a> 控制依赖</h3><p>SDK 只负责最基本的通信，通常不需要依赖过多外部的库，同时也不常用到 .NET 新版本的新特性。因此，我建议 SDK 应依赖尽可能少的外部库，并尽可能降低最低要求的 .NET 版本。</p><h3 id="开启-nullable-reference-types" tabindex="-1"><a class="header-anchor" href="#开启-nullable-reference-types" aria-hidden="true">#</a> 开启 nullable reference types</h3><p><a href="https://docs.microsoft.com/zh-cn/dotnet/csharp/nullable-references" target="_blank" rel="noopener noreferrer">可为空引用类型<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span></a> 是 C# 8.0 引入的新特性，建议启用，增强健壮性。</p><h2 id="完整框架" tabindex="-1"><a class="header-anchor" href="#完整框架" aria-hidden="true">#</a> 完整框架</h2><h3 id="di-是绝对必要的" tabindex="-1"><a class="header-anchor" href="#di-是绝对必要的" aria-hidden="true">#</a> DI 是绝对必要的</h3><p>当 bot 功能与个人信息强关联，并且需要从多个数据源更新数据时，DI 可以大大提升可维护性，减少屎山。这是我开发 bot 四年最直接的体会，DI 是绝对必要的。</p><h3 id="保留一定的灵活性" tabindex="-1"><a class="header-anchor" href="#保留一定的灵活性" aria-hidden="true">#</a> 保留一定的灵活性</h3><p>例如，我建议把事件的各属性设计成可修改的，并且允许任意构造或进行其他处理，以方便可能有需求的中间件。</p><div class="custom-container tip"><p class="custom-container-title">提示</p><p>这种灵活性还使适配其他协议（如钉钉、Discord）成为可能，但是……说到这儿好像有点儿多了。</p></div><h3 id="考虑-ide-集成" tabindex="-1"><a class="header-anchor" href="#考虑-ide-集成" aria-hidden="true">#</a> 考虑 IDE 集成</h3><p>在这种框架下开发机器人，往往需要用很多<a href="https://docs.microsoft.com/zh-cn/dotnet/csharp/programming-guide/concepts/attributes/" target="_blank" rel="noopener noreferrer">特性（Attribute）<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span></a>控制指令触发等。就像 VS 可以直接在 ASP.NET Core 项目中添加控制器并自动生成对应视图，框架开发者可以提供能够在 VS 等 IDE 中使用的模板，帮助 bot 开发者减少编写重复代码，快速创建项目或添加新功能等。</p><h2 id="泛泛的建议" tabindex="-1"><a class="header-anchor" href="#泛泛的建议" aria-hidden="true">#</a> 泛泛的建议</h2><p>这些建议不仅仅是针对开发 SDK 或框架，而是给新晋开发者在编程中的建议。</p><h3 id="多读文档-正确地运用-c-语言特性" tabindex="-1"><a class="header-anchor" href="#多读文档-正确地运用-c-语言特性" aria-hidden="true">#</a> 多读文档，正确地运用 C# 语言特性</h3><p>以异步编程为例，如果一个方法不打算返回任何东西，并且它是异步的，那么它的返回值类型可以为 <code>void</code> 或 <code>Task</code>（<code>ValueTask</code> 暂且不论）。那么应该返回什么呢？官方文档 <a href="https://docs.microsoft.com/zh-cn/dotnet/csharp/programming-guide/concepts/async/async-return-types" target="_blank" rel="noopener noreferrer">异步返回类型 (C#)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span></a> 就说明了只有此方法作为事件处理器，并且这个事件处理器要求返回 <code>void</code> 时，异步方法才应该用 <code>void</code> 作为返回值，其余情况都应该用 <code>Task</code> 作为返回值。而且，返回 <code>void</code> 的异步方法不应引发异常，如果引发，则会导致程序故障。</p><div class="custom-container tip"><p class="custom-container-title">私货（不是）</p><p>WudiLib 使用 C# 的事件机制处理 OneBot 中的事件，并且要求事件处理器返回 <code>void</code> 类型，这个设计并不好。想一想，为什么？<a href="https://github.com/int-and-his-friends/Sisters.WudiLib/blob/d66504387f253b0c2d556806ff3fd4e6cd382fa8/Sisters.WudiLib/Posts/ApiPostListener.cs#L598" target="_blank" rel="noopener noreferrer">点此查看所提及的源码<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span></a></p></div><details class="custom-container details"><p>消息的事件处理器常常是异步的，因为指令触发后常常需要异步地访问外部资源（如读取数据库等）。这种设计会使部分 bot 开发者无意识地编写返回 <code>void</code> 类型的异步方法。如果他们没有在方法内捕获并处理异常，就可能导致整个应用程序崩溃。事实上，返回 <code>void</code> 的异步方法几乎只在 GUI 程序中才会用到。</p></details><div class="custom-container tip"><p class="custom-container-title">提示</p><p>你能找出 <code>ValueTask</code> 的官方文档，阅读并总结出 <code>ValueTask</code> 的使用要点吗？</p><p><em>这部分文档翻译得不好，建议找到后阅读英文原文。</em></p></div><h3 id="多阅读优秀项目源码" tabindex="-1"><a class="header-anchor" href="#多阅读优秀项目源码" aria-hidden="true">#</a> 多阅读优秀项目源码</h3><p>我还建议每个开发者多阅读像 <a href="https://github.com/dotnet/runtime" target="_blank" rel="noopener noreferrer">.NET runtime<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span></a> 这样的优秀项目的源码，学习其中的思路和思想。</p><h2 id="总结" tabindex="-1"><a class="header-anchor" href="#总结" aria-hidden="true">#</a> 总结</h2><p>SDK 和框架的设计有相当大的自由发挥的空间，我在此只提出几点我认为无论如何设计，都应该认真考虑的建议。这是我针对在阅读其他 SDK 代码、文档，及与其开发者交流中发现的一部分常见问题提出的建议。这些建议基于我的个人经验，难免会有疏漏，再次恳请各位大佬不吝斧正。</p><p>关于我对理想的 SDK 和框架的想法，会在<a href="/lantu.html" class="">蓝图</a>中更新。</p></div><!--[--><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="external-link meta-item-label" href="https://github.com/b11p/Sisters.WudiLib-docs/edit/main/docs/gei-sdk-kaifazhedejianyi.md" rel="noopener noreferrer" target="_blank" aria-label="在 GitHub 上编辑此页"><!--[--><!--]--> 在 GitHub 上编辑此页 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></div><!----><!----></footer><!----><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/assets/app.b860a506.js" defer></script>
  </body>
</html>
